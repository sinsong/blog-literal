---
title: C++ 变量
date: 2018-07-07 23:47:20
tags:
- C++
---

变量提供一个具名的、可供程序操作的储存空间。
C++中每个变量拥有其数据类型，数据类型决定着变量所占内存空间大小和布局方式、该空间能储存的值的范围，以及变量能够参与的运算。

# 变量定义

类型说明符 声明符列表;

声明符列表中各个声明符用逗号分隔。每个声明符的类型由类型说明符决定。
定义时可以为每个变量名赋初始值（初始化）。（变量名在声明符里面）。

```C++
int sum = 0, value; //sum, value都是int类型，sum具有初始值0，value没有。
std::vector<int> is; //is是std::vector<int>类型。默认初始化。
std::string s("hello, world!"); //s通过一个字符串字面值初始化。
```

## 初始值

对象在创建时获得了一个特定的值，我们说这个对象被初始化(initialized)。用于初始化变量的值可以是任意复杂的表达式。
可以用先定义的变量初始化后定义的其他变量。

> 初始化不是赋值！
> 初始化是在创建变量时赋予其一个初始值。
> 赋值的含义是把对象的当前值擦除，以一个新值替代。（覆盖掉）

## 列表初始化

定义一个名为i的int变量并初始化为0，我们有4种方法。

```C++
int i = 0;
int i = {0};
int i(0);
int i{0};
```

用花括号进行初始化，成为列表初始化(list initialization)。初始化和赋值都行。
用于内置类型的变量时，如果使用列表初始化且初始值存在丢失信息的风险，编译器将报错。

```C++
int a{3.141592654}, b = {3.141592654}; //错误：存在丢失信息的风险
int c(3.141592654), d = 3.141592654; //正确：执行隐式转换
```

## 默认初始化

如果定义变量时没有指定初值，则变量被默认初始化(default initialized)，此时变量被赋予了“默认值”。默认值具体由变量类型决定，同时定义变量的位置也会对此有影响。

如果是内置类型的变量未被显式初始化，它的值由定义的位置决定。
定义于任何函数体之外的变量被初始化为0.
例外：定义在函数体内部的内置类型变量将不被初始化(uninitialized)。一个未被初始化的内置类型变量的值是未定义的，试图拷贝或其他形式访问此类值是危险的，将会引发错误。

每个类各自决定其初始化对象的方式。是否允许不经初始化就定义对象也由类自己决定。如果类允许这种行为，它将决定对象的初值到底是什么。

绝大多数类都支持无需显式初始化而定义对象，这样的类提供了一个合适的默认值。

> 定义于函数体内的内置类型的对象如果没有初始化，则其值未定义。类的对象如果没有显式地初始化，则其值由类决定。

# 声明

声明(declaration)使得名字为程序所知，一个文件中的代码要想使用其他文件中定义的名字，必须包含那个名字的声明。
而定义(definition)负责创建与名字关联的实体。

变量的定义不仅进行了定义，而且顺便进行了声明。

要想仅声明一个变量而不定义它，就在变量名前添加关键字`extern`，而且不要显示地初始化变量。

```C++
extern int i; //声明i，而没有定义
int j;        //声明并定义j
```

任何包含显式初始化的声明就会成为定义。extern即刻失效。extern语句如果包含初始值就会变成定义。

```C++
extern double pi = 3.141592654; //定义
```

函数体内部，如果试图初始化一个由extern关键字修饰的变量，将引发错误。

> 变量能且只能被定义一次（唯一定义原则），但是可以被多次声明。

# 标识符

C++的标识符由字母、数字和下划线组成，其中必须以字母或下划线开头。标识符的长度没有限制，但是对大小写敏感。

保留字，关键字，不能作为标识符。

C++为标准库保留了些名字。用户自定义的标识符中不能连续出现两个下划线，也不能以下划线紧连大写字母开头。定义在函数体外的标识符不能以下划线开头。

变量命名规范：
* 标识符要能体现实际含义。
* 变量名一般用小写字母开头，如index，不要使用Index或INDEX。
* 用户定义的类名一般以大写字母开头，如Sales_item。
* 如果标识符由多个单子组成，则单词间应有明显区分，如hello_world或helloWorld不要使用helloworld。

> 对于命名规范来说，若能坚持，必将有效。

# 作用域

同一个名字在程序中的不同位置，可能指向不同的实体，即作用域(scope)。名字的有效区域始于名字的声明语句，以声明语句所在的作用域末端为结束。
C++语言中大多数作用域以花括号分隔。

定义于所有花括号之外，拥有全局作用域(global scope)。声明之后，整个程序的范围内都可以使用。
定义在函数所在的块内，拥有块作用域(block scope)。

作用域能够嵌套。被嵌套的成为内层作用域(inner scope)，包含着别的作用域的作用域成为外层作用域(outer scope)。

正在作用域内(in scope)，改名字有效。

> 如果函数有可能用到某全局变量，则不宜在定义一个同名的全局变量。
